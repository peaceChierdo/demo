<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>JS Bin</title>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<style type="text/css">
  .ct{
  margin: 0 auto;
}
.content{
  position: relative;
  width: 100%;
}
.item{
  position: absolute;
  width: 200px;
  margin: 7px 7px;
  transition: all 1s;
}
.h1{
  height:200px;
  background-color: #753;  
}
.h2{
  height: 300px;
  background-color: #997;
}
.h3{
  height:400px;
  background-color: #698;
}
</style>
<body>
  <div class="ct">
    <div class="content">
      <div class="item h1">1</div>
      <div class="item h2">2</div>
      <div class="item h1">3</div>
      <div class="item h3">4</div>
      <div class="item h1">5</div>
      <div class="item h3">6</div>
      <div class="item h2">7</div>
      <div class="item h1">8</div>
      <div class="item h3">9</div>
      <div class="item h1">10</div>
      <div class="item h2">11</div>
    </div>
   </div>

   <script >
     //封装
      var wtf = (function(){

        function inite(){
          waterfall()
          $(window).resize(function(){
              waterfall()
          })  
        }
        
      function waterfall(){
      var $ct = $('.ct')
      var nodeWidth = $('.item').width()
      var colLength = parseInt($('.content').width()/nodeWidth)
      var itemArr = []
      for(var i = 0;i< colLength;i++){
        itemArr[i]=0
      }
        
      //   $ct.css({width: nodeWidth*colLength})       
      $('.item').each(function(){
        var min = Math.min.apply(null,itemArr)
        var minIndex = itemArr.indexOf(min)
        
        $(this).css({
          top: itemArr[minIndex],
          left: $(this).outerWidth(true)*minIndex
        })
        
        itemArr[minIndex] +=$(this).outerHeight(true)
      })  
      }
        
        return {
          init: inite
        }  
        
      })()


//  wtf.init() 

   </script>
</body>
</html>